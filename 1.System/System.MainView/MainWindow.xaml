<Window x:Class="System.MainView.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:System.MainView"
        xmlns:controls="clr-namespace:System.ICore.Control;assembly=System.ICore"
        xmlns:avalon="https://github.com/Dirkster99/AvalonDock"
        mc:Ignorable="d"
        Name="MainView"
        Title="MainWindow"
        Width="{Binding Config.ScreenWidth, FallbackValue=1500}"
        Height="{Binding Config.ScreenHeight, FallbackValue=950}"
        AllowsTransparency="False"
        Background="#00FFFFFF"
        FontWeight="Medium"
        Loaded="Window_Loaded"
        ResizeMode="NoResize"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        ContentRendered="MainView_ContentRendered">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/System.ICore;component/Resoure/DictionaryMain.xaml" />
                <ResourceDictionary Source="/System.ICore;component/Resoure/ButtonEx.xaml" />
            </ResourceDictionary.MergedDictionaries>

        </ResourceDictionary>
    </Window.Resources>
    <Border Background="{ DynamicResource MainColor}"  BorderBrush="{DynamicResource MainColor}" BorderThickness="2">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="32" />
                <RowDefinition Height="26" />
                <RowDefinition Height="*" />
                <RowDefinition Height="25" />
            </Grid.RowDefinitions>
            <Grid Grid.Row="0" Background="Transparent" MouseMove="TitleBar_MouseMove">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <StackPanel Grid.Column="0" Margin="0,0,10,0" HorizontalAlignment="Left" Orientation="Horizontal">
                    <Image Margin="10,2,0,2" HorizontalAlignment="Center" VerticalAlignment="Center"  />
                    <TextBlock Margin="20,2,0,2" VerticalAlignment="Center" FontSize="16" Foreground="White" Text="{Binding Config.Title}" />
                </StackPanel>
                <StackPanel Grid.Column="2" Margin="0,0,15,0" HorizontalAlignment="Right" Orientation="Horizontal">

                    <controls:ButtonEx
         Width="32"
         Height=" 32"
         Margin="0,0,15,0"
         Background="Transparent"
         ButtonType="Icon"
         Command="{Binding OpenLoginView}"
         Cursor="Hand"
         Icon="pack://application:,,,/System.ICore;Component/Image/login32.png" />

                    <controls:ButtonEx
         Width="32"
         Height=" 32"
         Margin="0,0,30,0"
         Background="Transparent"
         ButtonType="Icon"
         Command="{Binding OpenMainSetView}"
         Cursor="Hand"
         Icon="pack://application:,,,/System.ICore;Component/Image/system.png" />


                    <Button Width="30" Height=" 30" Margin="0,0,15,0" Click="btn_min_Click" Cursor="Hand">
                        <Button.Template>
                            <ControlTemplate>
                                <Grid Background="Transparent">
                                    <Rectangle Width="18" Height="3" Fill="#13227a" />
                                </Grid>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    <Button Width="30" Height=" 30" Margin="0,0,15,0" Click="btn_max_Click" Cursor="Hand">
                        <Button.Template>
                            <ControlTemplate>
                                <Grid Background="Transparent">
                                    <Rectangle Width="18" Height="18" Stroke="#13227a" StrokeThickness="3" />
                                </Grid>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    <Button Width="30" Height="30" Command="{Binding MainClose}" Cursor="Hand">
                        <Button.Template>
                            <ControlTemplate>
                                <Grid Background="Transparent">
                                    <Line
                         Width="18"
                         Height="18"
                         Stroke="#13227a"
                         StrokeThickness="3"
                         X1="0"
                         X2="18"
                         Y1="0"
                         Y2="18" />
                                    <Line
                         Width="18"
                         Height="18"
                         Stroke="#13227a"
                         StrokeThickness="3"
                         X1="18"
                         X2="0"
                         Y1="0"
                         Y2="18" />
                                </Grid>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </StackPanel>
            </Grid>


            <DockPanel Grid.Row="1" Background="#FF4EAEFF">
                <Menu x:Name="MainMenu" Height="25" Background="AliceBlue" DockPanel.Dock="Top">
                    <MenuItem x:Name="SystemMenuItem" Margin="0,0,10,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Background="AliceBlue">
                        <MenuItem.Icon>
                            <Image Source="pack://application:,,,/System.ICore;Component/Image/SystemSet.png" />
                        </MenuItem.Icon>
                        <MenuItem.Header>
                            <TextBlock VerticalAlignment="Center" Text="系统" />
                        </MenuItem.Header>
                    </MenuItem>
                    <MenuItem x:Name="SetParaMenuItem" Margin="0,0,10,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Background="AliceBlue">
                        <MenuItem.Icon>
                            <Image Source="pack://application:,,,/System.ICore;Component/Image/SettingPara.png" />
                        </MenuItem.Icon>
                        <MenuItem.Header>
                            <TextBlock VerticalAlignment="Center" Text="设置" />
                        </MenuItem.Header>
                        <MenuItem HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Background="AliceBlue" Command="{Binding SaveDockManagerXml}">
                            <MenuItem.Icon>
                                <Image Source="pack://application:,,,/System.ICore;Component/Image/Save.png" />
                            </MenuItem.Icon>
                            <MenuItem.Header>
                                <TextBlock VerticalAlignment="Center" Text="保存布局" />
                            </MenuItem.Header>
                        </MenuItem>


                    </MenuItem>

                    <MenuItem x:Name="DeviceMenuItem" Margin="0,0,10,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Background="AliceBlue">
                        <MenuItem.Icon>
                            <Image Source="pack://application:,,,/System.ICore;Component/Image/Device32.png" />
                        </MenuItem.Icon>
                        <MenuItem.Header>
                            <TextBlock VerticalAlignment="Center" Text="设备" />
                        </MenuItem.Header>
                        <MenuItem Height="30" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Header="相机" Visibility="Collapsed">
                            <MenuItem.Icon>
                                <Image Source="pack://application:,,,/System.ICore;Component/Image/getimage.png" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Height="30" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Header="光源" Visibility="Collapsed">
                            <MenuItem.Icon>
                                <Image Source="pack://application:,,,/System.ICore;Component/Image/光源控制器.png" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Height="30" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Header="PLC" Visibility="Collapsed">
                            <MenuItem.Icon>
                                <Image Source="pack://application:,,,/System.ICore;Component/Image/PLC通讯.png" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Height="30" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Header="通讯" Visibility="Collapsed">
                            <MenuItem.Icon>
                                <Image Source="pack://application:,,,/System.ICore;Component/Image/TCPClient.png" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Height="30" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Header="扫码枪" Visibility="Collapsed">
                            <MenuItem.Icon>
                                <Image Source="pack://application:,,,/System.ICore;Component/Image/扫码.png" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Height="30" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Header="仪表" Visibility="Collapsed">
                            <MenuItem.Icon>
                                <Image Source="pack://application:,,,/System.ICore;Component/Image/仪表.png" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Height="30" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Header="机器人" Visibility="Collapsed">
                            <MenuItem.Icon>
                                <Image Source="pack://application:,,,/System.ICore;Component/Image/机器人.png" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Height="30" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Header="其它" Visibility="Collapsed">
                            <MenuItem.Icon>
                                <Image Source="pack://application:,,,/System.ICore;Component/Image/Devices.png" />
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>

                    <MenuItem x:Name="VisionMenuItem" Margin="0,0,10,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Background="AliceBlue">
                        <MenuItem.Icon>
                            <Image Source="pack://application:,,,/System.ICore;Component/Image/Vision.png" />
                        </MenuItem.Icon>
                        <MenuItem.Header>
                            <TextBlock VerticalAlignment="Center" Text="视图" />
                        </MenuItem.Header>
                    </MenuItem>


                    <MenuItem x:Name="ToolMenuItem" Margin="0,0,10,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Background="AliceBlue">
                        <MenuItem.Icon>
                            <Image Source="pack://application:,,,/System.ICore;Component/Image/工具.png" />
                        </MenuItem.Icon>
                        <MenuItem.Header>
                            <TextBlock VerticalAlignment="Center" Text="工具" />
                        </MenuItem.Header>

                    </MenuItem>
                    <MenuItem x:Name="DebugMenuItem" Margin="0,0,10,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Background="AliceBlue">
                        <MenuItem.Icon>
                            <Image Source="pack://application:,,,/System.ICore;Component/Image/调试.png" />
                        </MenuItem.Icon>
                        <MenuItem.Header>
                            <TextBlock VerticalAlignment="Center" Text="调试" />
                        </MenuItem.Header>
                    </MenuItem>
                    <MenuItem x:Name="HelpMenuItem" Margin="0,0,10,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Background="AliceBlue">
                        <MenuItem.Icon>
                            <Image Source="pack://application:,,,/System.ICore;Component/Image/help.png" />
                        </MenuItem.Icon>
                        <MenuItem.Header>
                            <TextBlock VerticalAlignment="Center" Text="帮助" />
                        </MenuItem.Header>
                    </MenuItem>
                </Menu>
                <ToolBar />
            </DockPanel>

            <Grid Grid.Row="2" Background="AliceBlue">
                <avalon:DockingManager x:Name="DockManager" 
          AllowMixedOrientation="True" 
          AutoWindowSizeWhenOpened="True" 
          IsVirtualizingAnchorable="True" 
          IsVirtualizingDocument="True">

                    <avalon:DockingManager.Theme>
                        <avalon:Vs2013LightTheme/>
                    </avalon:DockingManager.Theme>

                    <DockingManager.DocumentHeaderTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" >
                                <Image Margin="0,0,2,0" Source="{Binding IconSource}" Height="15" Width="15" Stretch="Uniform"/>
                                <TextBlock Text="{Binding Title}" TextTrimming="CharacterEllipsis" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </DataTemplate>
                    </DockingManager.DocumentHeaderTemplate>

                    <DockingManager.AnchorableHeaderTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" >
                                <Image Margin="0,0,2,0" Source="{Binding IconSource}" Height="15" Width="15" Stretch="Uniform"/>
                                <TextBlock Text="{Binding Title}" TextTrimming="CharacterEllipsis" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </DataTemplate>
                    </DockingManager.AnchorableHeaderTemplate>


                    <avalon:LayoutRoot x:Name="Root">
                        <avalon:LayoutPanel x:Name="Panel">
                            <avalon:LayoutAnchorablePaneGroup x:Name="AnchorableGroup" DockWidth="260">
                                <avalon:LayoutAnchorablePane x:Name="AnchorablePane" />
                            </avalon:LayoutAnchorablePaneGroup>
                            <avalon:LayoutDocumentPaneGroup x:Name="DocumentGroup">
                                <avalon:LayoutDocumentPane x:Name="DocumentPane" />
                            </avalon:LayoutDocumentPaneGroup>
                        </avalon:LayoutPanel>
                    </avalon:LayoutRoot>
                </avalon:DockingManager>
            </Grid>


            <WrapPanel
    Grid.Row="3"
    HorizontalAlignment="Right"
    VerticalAlignment="Center"
    Background="Transparent"
    MouseMove="TitleBar_MouseMove"
    Orientation="Horizontal">
                <TextBlock Margin="4,0,4,0" VerticalAlignment="Center" Text="当前配方:" Foreground="White"  />
                <Label VerticalAlignment="Center" Margin="0,0,2,0" Content="{Binding CurUseFormulaName}" Foreground="White"/>
                <controls:ButtonEx
        Width="30"
        Height="20"
        Margin="2,2,4,2"
        VerticalAlignment="Center"
        Background="#FF00FF12"
        ButtonType="Icon"
        Command="{Binding OpenFormulaView}"
        Icon="pack://application:,,,/System.ICore;Component/Image/配方方案.png" />
                <Line
        Width="4"
        Height="18"
        Stroke="#13227a"
        StrokeThickness="1"
        X1="0"
        X2="0"
        Y1="0"
        Y2="18" />
                <TextBlock Margin="4,0,2,0" VerticalAlignment="Center" Text="用户:" Foreground="White"/>
                <Label VerticalAlignment="Center" Content="{Binding CurUserNameAndLevel}" Foreground="White"/>

                <Line
        Width="4"
        Height="18"
        Stroke="#13227a"
        StrokeThickness="1"
        X1="0"
        X2="0"
        Y1="0"
        Y2="18" />
                <TextBlock Margin="4" VerticalAlignment="Center" Text="CPU:" Foreground="White"/>
                <Label Width="60" VerticalAlignment="Center" Content="{Binding CPU}" Foreground="White"/>
                <TextBlock Margin="4" VerticalAlignment="Center" Text="内存:" Foreground="White"/>
                <Label Width="60" VerticalAlignment="Center" Content="{Binding Memory}" Foreground="White"/>
                <Line
        Width="4"
        Height="18"
        Stroke="#13227a"
        StrokeThickness="1"
        X1="0"
        X2="0"
        Y1="0"
        Y2="18" />
                <TextBlock Margin="4,0,4,0" VerticalAlignment="Center" Text="当前时间:" Foreground="White"/>
                <Label VerticalAlignment="Center" Content="{Binding CurTime}" Foreground="White"/>
            </WrapPanel>
        </Grid>

    </Border>


</Window>
